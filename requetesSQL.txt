1/
SELECT specialite FROM Medecins WHERE idMedecin = 3;

2/
SELECT nom, prenom FROM Medecins WHERE anneesExperience > 10;

3/
SELECT COUNT(*) FROM Examens;

4/
SELECT E.nomExamen, E.cout, MAX(PE.dateExamen) FROM 
Examens E JOIN PatientExamens PE ON E.idExamen = PE.idExamen 
WHERE E.cout = (SELECT MAX(cout) FROM Examens) GROUP BY E.nomExamen, E.cout;

5/
SELECT prenom, nom, EXTRACT (YEAR FROM age(CURRENT_DATE, dateDeNaissance)) AS age 
FROM Patients 
ORDER BY prenom DESC, nom DESC;

6/
SELECT AVG(cout) FROM Examens;

7/
SELECT M.nom, M.prenom, COUNT(RV.idrendezvous) FROM Medecins M 
JOIN Rendezvous RV ON M.idMedecin = RV.idMedecin 
where RV.dateRendezVous  > '2023-09-21'
GROUP BY M.nom, M.prenom;

8/
SELECT P.nom, P.prenom, P.numeroDeTelephone 
FROM Patients P 
JOIN Rendezvous R ON P.idPatient = R.idPatient 
WHERE R.dateRendezVous BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '7 days';

9/
SELECT P.nom, P.prenom, SUM(E.cout) 
FROM Patients P 
JOIN PatientExamens PE ON P.idPatient = PE.idPatient 
JOIN Examens E ON PE.idExamen = E.idExamen 
JOIN Services S ON E.idService = S.idService 
WHERE P.idPatient = 4 AND S.nomService LIKE 'C%' 
GROUP BY P.nom, P.prenom;

10/
SELECT DISTINCT Pat.nom, Pat.prenom 
FROM Patients Pat 
JOIN Rendezvous R ON Pat.idPatient = R.idPatient 
JOIN Medecins M ON R.idMedecin = M.idMedecin 
WHERE M.anneesExperience = (SELECT MAX(anneesExperience) FROM Medecins);

11/
SELECT DISTINCT P.nom, P.prenom 
FROM Patients P 
JOIN PatientExamens PE ON P.idPatient = PE.idPatient 
JOIN Examens E ON E.idExamen = PE.idExamen 
WHERE E.cout > 200
GROUP BY P.nom, P.prenom Having SUM(E.cout) > 2000;

12/
SELECT M.nom, M.prenom
FROM Medecins M 
JOIN Rendezvous R ON M.idMedecin = R.idMedecin 
WHERE R.dateRendezVous BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '6 months'
GROUP BY M.nom, M.prenom 
ORDER BY COUNT(DISTINCT R.idPatient) DESC
LIMIT 1;
// tous 1

13/
SELECT nom, prenom 
FROM Medecins 
WHERE idMedecin NOT IN (SELECT DISTINCT idMedecin FROM Rendezvous);
// rien

14/
SELECT P.nom, P.prenom
FROM Patients P 
JOIN PatientExamens PE ON P.idPatient = PE.idPatient 
WHERE PE.resultat != 'RÃ©sultats normaux' 
GROUP BY P.nom, P.prenom 
ORDER BY COUNT(PE.idExamen) DESC
LIMIT 1; 
// tous 1

15/
// a voir!!

16/
// a voir!!
